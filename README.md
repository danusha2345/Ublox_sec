# U-blox ECDSA Security Auditor

–≠—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π —Å—Ç–æ–π–∫–æ—Å—Ç–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã—Ö –ø—Ä–∏–µ–º–Ω–∏–∫–æ–≤ **u-blox** (—Å–µ—Ä–∏–∏ M8, M10, F9).

–ü—Ä–æ–≥—Ä–∞–º–º–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ü–∏—Ñ—Ä–æ–≤—ã–µ –ø–æ–¥–ø–∏—Å–∏ (ECDSA secp256r1), –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã–µ –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö `UBX-SEC`, –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª (RNG) —á–∏–ø–∞. –°–ª–∞–±—ã–π RNG –≤ —ç—Ç–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á –∏ –ø–æ–¥–¥–µ–ª—ã–≤–∞—Ç—å GPS-—Å–∏–≥–Ω–∞–ª—ã.

![Rust](https://img.shields.io/badge/built_with-Rust-red)
![License](https://img.shields.io/badge/license-MIT-blue)

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

*   **–í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å (`rayon`) –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≥–∏–≥–∞–±–∞–π—Ç–Ω—ã—Ö –ª–æ–≥–æ–≤ –∑–∞ —Å–µ–∫—É–Ω–¥—ã.
*   **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ä—Å–∏–Ω–≥:** –ù–∞—Ö–æ–¥–∏—Ç –ø–∞–∫–µ—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ `UBX-SEC` –≤ "—Å—ã—Ä–æ–º" –±–∏–Ω–∞—Ä–Ω–æ–º –ø–æ—Ç–æ–∫–µ.
*   **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:** –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ (PNG) –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ —ç–Ω—Ç—Ä–æ–ø–∏–∏.
*   **–î–µ—Ç–µ–∫—Ü–∏—è —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π:**
    *   üõë **Sony PS3 Attack (Nonce Reuse):** –ü–æ–∏—Å–∫ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ —Å–ª—É—á–∞–π–Ω–æ–≥–æ —á–∏—Å–ª–∞ $k$. –ü–æ–∑–≤–æ–ª—è–µ—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á.
    *   üìâ **Biased Nonce (Lattice Attack):** –ü–æ–∏—Å–∫ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Å–º–µ—â–µ–Ω–∏–π –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ $k$.
    *   üî® **Signature Malleability:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ High-S –∑–Ω–∞—á–µ–Ω–∏–π.
*   **–≠–∫—Å–ø–æ—Ä—Ç:** –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö (`hnp_capture.csv`) –¥–ª—è –∫—Ä–∏–ø—Ç–æ–∞–Ω–∞–ª–∏–∑–∞ —á–µ—Ä–µ–∑ SageMath.

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

–í–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π [Rust](https://www.rust-lang.org/tools/install).

1.  –°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
    ```bash
    git clone https://github.com/–í–ê–®_–ù–ò–ö/ubx_audit.git
    cd ubx_audit
    ```

2.  –°–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è release-—Ä–µ–∂–∏–º –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏):
    ```bash
    cargo build --release
    ```

## üõ† –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –†–µ–∂–∏–º —Å–∏–º—É–ª—è—Ü–∏–∏ (–¢–µ—Å—Ç)
–ï—Å–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –±–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤, –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Å "–ø–ª–æ—Ö–∏–º" –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–º —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª, —á—Ç–æ–±—ã –≤—ã —É–≤–∏–¥–µ–ª–∏, –∫–∞–∫ –≤—ã–≥–ª—è–¥—è—Ç —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–∞—Ö.

```bash
cargo run --release
```

### 2. –ê–Ω–∞–ª–∏–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥–∞
–ü–æ–¥–∞–π—Ç–µ –Ω–∞ –≤—Ö–æ–¥ –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª —Å –ª–æ–≥–æ–º u-blox (–æ–±—ã—á–Ω–æ `.ubx` –∏–ª–∏ `.bin`), –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–π —Å UART/USB –ø–æ—Ä—Ç–∞ –ø—Ä–∏–µ–º–Ω–∏–∫–∞.

```bash
cargo run --release -- –ø—É—Ç—å/–∫/—Ñ–∞–π–ª—É_–ª–æ–≥–∞.ubx
```

---

## üìä –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–ü–æ—Å–ª–µ —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Å–æ–∑–¥–∞—Å—Ç –ø–∞–ø–∫—É `plots/` —Å —á–µ—Ç—ã—Ä—å–º—è –≥—Ä–∞—Ñ–∏–∫–∞–º–∏. –í–æ—Ç –∫–∞–∫ –∏—Ö —á–∏—Ç–∞—Ç—å:

### 1. `distribution_r.png` (–°–∞–º—ã–π –≤–∞–∂–Ω—ã–π)
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–π —á–∞—Å—Ç–∏ –ø–æ–¥–ø–∏—Å–∏ (Nonce $R$).
*   ‚úÖ **–ù–æ—Ä–º–∞:** –õ–∏–Ω–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å **–ø–ª–æ—Å–∫–æ–π** –∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–π (—Å –Ω–µ–±–æ–ª—å—à–∏–º —à—É–º–æ–º). –≠—Ç–æ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ.
*   ‚ùå **–£—è–∑–≤–∏–º–æ—Å—Ç—å:** –ï—Å–ª–∏ –≤—ã –≤–∏–¥–∏—Ç–µ "—Ö–æ–ª–º" (–∫—Ä–∏–≤—É—é –ì–∞—É—Å—Å–∞), –Ω–∞–∫–ª–æ–Ω –∏–ª–∏ —è–≤–Ω—ã–µ –ø—Ä–æ–≤–∞–ª—ã ‚Äî RNG –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º. –≠—Ç–æ —É—è–∑–≤–∏–º–æ—Å—Ç—å –¥–ª—è **Lattice Attack**.

### 2. `bit_bias.png` (–ö–∞—Ä—Ç–∞ –±–∏—Ç–æ–≤)
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–æ—è–≤–ª–µ–Ω–∏—è `1` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ 512 –±–∏—Ç–æ–≤ –ø–æ–¥–ø–∏—Å–∏.
*   ‚úÖ **–ù–æ—Ä–º–∞:** –í—Å–µ —Ç–æ—á–∫–∏ –¥–æ–ª–∂–Ω—ã –ª–µ–∂–∞—Ç—å –Ω–∞ –∑–µ–ª–µ–Ω–æ–π –ª–∏–Ω–∏–∏ (0.5).
*   ‚ùå **–£—è–∑–≤–∏–º–æ—Å—Ç—å:** –ö—Ä–∞—Å–Ω—ã–µ —Ç–æ—á–∫–∏, —É–ª–µ—Ç–µ–≤—à–∏–µ –∫ 0.0 –∏–ª–∏ 1.0. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –±–∏—Ç "–∑–∞–ª–∏–ø" (–≤—Å–µ–≥–¥–∞ –Ω–æ–ª—å –∏–ª–∏ –≤—Å–µ–≥–¥–∞ –µ–¥–∏–Ω–∏—Ü–∞).

### 3. `byte_hist.png` (–ß–∞—Å—Ç–æ—Ç–∞ –±–∞–π—Ç–æ–≤)
*   ‚úÖ **–ù–æ—Ä–º–∞:** –í—Å–µ —Å—Ç–æ–ª–±—Ü—ã –ø—Ä–∏–º–µ—Ä–Ω–æ –æ–¥–Ω–æ–π –≤—ã—Å–æ—Ç—ã.
*   ‚ùå **–£—è–∑–≤–∏–º–æ—Å—Ç—å:** –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –±–∞–π—Ç—ã –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ –∏–ª–∏ –Ω–µ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤–æ–≤—Å–µ.

### 4. –ö–æ–Ω—Å–æ–ª—å–Ω—ã–π –≤—ã–≤–æ–¥ (Critical Checks)
–ü—Ä–æ–≥—Ä–∞–º–º–∞ –≤—ã–≤–µ–¥–µ—Ç –∫—Ä–∞—Å–Ω–æ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, –µ—Å–ª–∏ –Ω–∞–π–¥–µ—Ç **–î—É–±–ª–∏–∫–∞—Ç R**.
> **CRITICAL VULNERABILITY: FOUND DUPLICATE R**
>
> –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –¥–≤–∞ —Ä–∞–∑–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è –±—ã–ª–∏ –ø–æ–¥–ø–∏—Å–∞–Ω—ã –æ–¥–Ω–∏–º –∏ —Ç–µ–º –∂–µ —Å–ª—É—á–∞–π–Ω—ã–º —á–∏—Å–ª–æ–º. –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω –∞–ª–≥–µ–±—Ä–∞–∏—á–µ—Å–∫–∏.

---

## üíÄ –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è (Research Only)

–ï—Å–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –æ–±–Ω–∞—Ä—É–∂–∏–ª–∞ —Å–º–µ—â–µ–Ω–∏–µ (Bias) –∏–ª–∏ –¥—É–±–ª–∏–∫–∞—Ç—ã, –æ–Ω–∞ —Å–æ—Ö—Ä–∞–Ω–∏—Ç —Ñ–∞–π–ª `hnp_capture.csv`. –≠—Ç–æ—Ç —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—ã—Ä—ã–µ –ø–æ–¥–ø–∏—Å–∏.

–î–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∫–ª—é—á–∞ (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Å–º–µ—â–µ–Ω–∏—è) –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **SageMath** –∏ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Ä–µ—à–µ–Ω–∏—è *Hidden Number Problem (HNP)*.

–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã CSV:
```csv
packet_idx, r_hex, s_hex, full_payload_hex
```
*–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `full_payload_hex` –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Ö–µ—à–∞ —Å–æ–æ–±—â–µ–Ω–∏—è $Z$ —Å–æ–≥–ª–∞—Å–Ω–æ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤–∞—à–µ–π –≤–µ—Ä—Å–∏–∏ –ø—Ä–æ—à–∏–≤–∫–∏ u-blox.*

---

## ‚öñÔ∏è –î–∏—Å–∫–ª–µ–π–º–µ—Ä

–≠—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –Ω–∞–ø–∏—Å–∞–Ω –≤ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ü–µ–ª—è—Ö.
–ê–≤—Ç–æ—Ä—ã –Ω–µ –Ω–µ—Å—É—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω–æ–≥–æ –ü–û –¥–ª—è –Ω–µ–∑–∞–∫–æ–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π.
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –Ω–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–∏, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –≤–∞–º, –∏–ª–∏ –Ω–∞ –∫–æ—Ç–æ—Ä–æ–µ —É –≤–∞—Å –µ—Å—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –∞—É–¥–∏—Ç.

---


**–õ–∏—Ü–µ–Ω–∑–∏—è:** MIT
